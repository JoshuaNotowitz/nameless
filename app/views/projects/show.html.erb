
<div class="row">
  <div class="col-md-8">
    <h1 class="project-header">
      <%= @project.name %> Project
    </h1>
    <%= link_to("Edit", edit_user_project_path(@current_user, @project), class: "right") %>
    <!-- description -->
    <h5>Description</h5>
    <p><%= @project.description %></p>


  </div>
  <div class="col-md-4">
    <img src="<%= @project.photo_url%>" class="project-image" style="display:block;">
    <br>
    <!-- avatar -->
    <h5>Project Owner</h5>
    <div class="row">
      <div class="col-md-2">
        <img class="avatar" src=" <%= @user.picurl %> " alt="profile pic">
      </div>
      <div class="col-md-10">
        <p><%= @user.firstname %> <%= @user.lastname %></p>
      </div>
    </div>
    <!-- tags -->
    <br>
    <h5>Related Tags</h5>
    <% @tags.each do |tag| %>
      <span class="label label-info">
        <%= tag.name %>
      </span>
    <% end %>
      <br>
    <br>
  </div>
</div>

<br>
<% @names.each do |n| %>
<button class="btn btn-warning name" id="<%= n.id %>"><%= n.name %></button>
<div id="voteCount"></div>
<% end %>


<script id="voting-template" type="text/x-handlebars-template">
		{{#each voteData}}
				<div>
					{{totalvotes}}
				</div>
		{{/each}}
	</script>

<script type="text/javascript">
$(document).ready(function(){
	$(".name").on("click", function(event) {
		$.ajax({
			type: "POST",
			url: "/users/<%= @project.user_id %>/projects/<%= @project.id %>",
			data: {nameid: this.id, voterid: <%= @current_user.id %>},
			success: function(data, textStatus, jqXHR) { 
				var source = $("#voting-template").html();

				var template = Handlebars.compile(source);

				var html = template({voteData: data});

				$("#voteCount").html(html);
      },
      error: function(jqXHR, textStatus, errorThrown) {
      	console.log("Error=" + errorThrown)
        alert("Error=" + errorThrown);
      },
			dataType: "json"
		});
	})
})

</script>

<script>
engine();
</script>
